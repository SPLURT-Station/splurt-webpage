---
import { getImage, Image } from "astro:assets";
import logo from "../assets/logos/splurtpaw2_alt3.png";
import backgroundImage from "../assets/backgrounds/banner.png";
import "../styles/work-in-progress.css";

const optimizedBackgroundImage = await getImage({
  src: backgroundImage,
  format: "webp",
});
---

<!-- Age Gate Overlay -->
<section id="age-gate-overlay" class="age-gate-overlay">
  <div
    class="age-gate-modal"
    role="dialog"
    aria-modal="true"
    aria-labelledby="age-gate-title"
    aria-describedby="age-gate-description"
  >
    <div class="age-gate-header">
      <div class="age-gate-logo-wrap">
        <Image
          src={logo}
          alt="Splurt Logo"
          class="age-gate-logo"
          width={72}
          height={72}
          loading="eager"
        />
        <span class="age-gate-badge" aria-hidden="true">18+</span>
      </div>
      <h2 id="age-gate-title" class="age-gate-title">Adults Only</h2>
    </div>
    <p id="age-gate-description" class="age-gate-text">
      This website contains content intended for adults. By clicking
      <strong>Continue</strong>, you confirm that you are at least 18 years of
      age.
    </p>
    <div class="age-gate-actions">
      <button id="age-continue" class="age-continue-button">Continue</button>
    </div>
  </div>
  <script is:inline>
    (function () {
    const STORAGE_KEY = "splurt_age_confirmed";
    const overlayId = "age-gate-overlay";
    const titleId = "age-gate-title";
    function showOverlay() {
      const el = document.getElementById(overlayId);
      if (el) {
        el.style.display = "flex";
        document.body.classList.add("age-gate-open");
      }
    }
    function hideOverlay() {
      const el = document.getElementById(overlayId);
      if (el) {
        el.style.display = "none";
        document.body.classList.remove("age-gate-open");
      }
    }
    if (typeof window !== "undefined") {
      if (localStorage.getItem(STORAGE_KEY) === "true") {
        hideOverlay();
      } else {
        showOverlay();
      }
      window.addEventListener("click", function (ev) {
        const target = ev.target;
        if (
          target && target instanceof HTMLElement &&
          target.id === "age-continue"
        ) {
          try {
            localStorage.setItem(STORAGE_KEY, "true");
          } catch (_) { /* ignore */ }
          hideOverlay();
        }
      });
    }
  })();
  </script>
</section>

<section
  class="container"
  style={`background-image: linear-gradient(135deg, rgba(5, 0, 15, 0.95) 0%, rgba(25, 5, 30, 0.92) 30%, rgba(60, 15, 40, 0.88) 70%, rgba(120, 30, 80, 0.85) 100%), url(${optimizedBackgroundImage.src})`}
>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <a href="/" class="nav-link active">Home</a>
    <a href="https://github.com/SPLURT-Station/S.P.L.U.R.T-tg" class="nav-link"
    >GitHub</a>
    <a href="https://wiki.splurt.space/Rules" class="nav-link">Rules</a>
    <a href="https://wiki.splurt.space" class="nav-link">Wiki</a>
    <a href="https://discord.gg/splurt" class="nav-link">Discord</a>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <Image
      src={logo}
      alt="Splurt Logo"
      class="logo"
      width={200}
      height={200}
      loading="eager"
    />
    <h1 class="wip-text">Work In Progress...</h1>
    <button
      class="play-button"
      onclick="window.location.href='byond://play.splurt.space:42069'"
    >
      Play
    </button>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <a
      href="https://github.com/SPLURT-Station/splurt-webpage"
      class="footer-link"
    >
      <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
        <path
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
        />
      </svg>
      S.P.L.U.R.T. Station Webpage - View on GitHub
    </a>
  </footer>
</section>
