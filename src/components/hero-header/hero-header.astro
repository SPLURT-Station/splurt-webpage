---
import { getImage, Image } from "astro:assets";
import DiscordIcon from "~icons/ic/baseline-discord";
import ArrowDownIcon from "~icons/mdi/arrow-down";
import bannerPoster from "/src/assets/backgrounds/banner.png";
import bannerVideo from "/src/assets/banner-video.mp4";
import logo from "/src/assets/logos/splurtlogo.png";
import "./hero-header.css";

const optimizedBannerPoster = await getImage({
	src: bannerPoster,
	width: 550,
	height: 273,
	format: "webp",
	quality: 80,
});
---

<header class="intro">
	<div class="relative z-30">
		<Image
			src={logo}
			alt="S.P.L.U.R.T. Station"
			class="logo max-w-full p-4"
			width={800}
			loading="eager"
		/>
		<div
			class="text-center mt-8 mx-4 flex flex-col sm:flex-row gap-4 justify-center items-center font-spess"
		>
			<a
				href="/how-to-play"
				class="cta--highlighted text-xl px-12 py-4 rounded-full text-white font-semibold uppercase tracking-normal transition-all inline-block no-underline cursor-pointer hover:-translate-y-0.5 active:translate-y-0"
			>
				Play Now
			</a>
			<a
				href="https://discord.gg/splurt"
				class="cta--discord text-xl px-12 py-4 rounded-full text-white font-semibold uppercase tracking-normal transition-all inline-flex items-center gap-2 no-underline cursor-pointer hover:-translate-y-0.5 active:translate-y-0"
				target="_blank"
				rel="noopener external"
			>
				Discord
				<DiscordIcon
					class="discord-icon"
					width={20}
					height={20}
					aria-hidden="true"
				/>
			</a>
		</div>
	</div>
	<video
		id="hero-video"
		playsinline
		autoplay
		loop
		muted
		preload="auto"
		poster={optimizedBannerPoster.src}
		class="absolute inset-0 z-10"
	>
		<source src={bannerVideo} type="video/mp4">
	</video>
	<button
		id="learn-more-btn"
		class="learn-more-btn absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex items-center gap-2 px-6 py-3 rounded-full text-white font-semibold uppercase tracking-normal transition-all cursor-pointer hover:-translate-y-1 active:translate-y-0"
		aria-label="Learn more"
		onclick="(function() { const header = document.querySelector('.intro'); if (header) { const headerBottom = header.getBoundingClientRect().bottom + window.pageYOffset; window.scrollTo({ top: headerBottom, behavior: 'smooth' }); } })()"
	>
		Learn more
		<ArrowDownIcon
			class="arrow-icon"
			width={20}
			height={20}
			aria-hidden="true"
		/>
	</button>
</header>

<script>
	// Only show video if user hasn't requested reduced motion
	if (typeof window !== "undefined") {
		const video = document.getElementById("hero-video");
		if (video && window.matchMedia("(prefers-reduced-motion)").matches) {
			video.style.display = "none";
		}
	}
</script>
